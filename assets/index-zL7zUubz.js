import{c as R}from"./elements-gKuY0iSU.js";import{az as S,a2 as W,j,aB as T,aC as b,a8 as i,_ as D,F as G,e as P,m as V,q as y,w as z,W as s,Q as o,p as c,N as M,P as h,O as L}from"./index-h4E0gBbf.js";import{c as Y}from"./shared-GaGJ2G_i.js";import{A as E}from"./appType-xf773rte.js";const Z="background-image",F="lazy-loading",Q="lazy-error",v="lazy-attempt",$=["scroll","wheel","mousewheel","resize","animationend","transitionend","touchmove"],p="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",l=[],d=[],w=Y(100),e={loading:p,error:p,attempt:3,throttleWait:300,events:$};let _=b(u,e.throttleWait);function m(t,a){t._lazy.arg===Z?t.style.backgroundImage=`url(${a})`:t.setAttribute("src",a)}function q(t){t._lazy.loading&&m(t,t._lazy.loading),u()}function H(t){t._lazy.error&&m(t,t._lazy.error),t._lazy.state="error",A(t),u()}function I(t,a){m(t,a),t._lazy.state="success",A(t),u()}function K(t){var a;d.includes(t)||(d.push(t),(a=e.events)==null||a.forEach(n=>{t.addEventListener(n,_,{passive:!0})}))}function X(){d.forEach(t=>{var a;(a=e.events)==null||a.forEach(n=>{t.removeEventListener(n,_)})}),d.length=0}function J(t,a){const n={loading:t.getAttribute(F)??e.loading,error:t.getAttribute(Q)??e.error,attempt:t.getAttribute(v)?Number(t.getAttribute(v)):e.attempt};t._lazy={src:a.value,arg:a.arg,currentAttempt:0,state:"pending",attemptLock:!1,...n},m(t,p),W(e.filter,t._lazy)}function tt(t,a){const n=new Image;n.src=a,t._lazy.preloadImage=n,n.addEventListener("load",()=>{t._lazy.attemptLock=!1,w.add(a),I(t,a)}),n.addEventListener("error",()=>{t._lazy.attemptLock=!1,t._lazy.currentAttempt>=t._lazy.attempt?H(t):x(t)})}function x(t){if(t._lazy.attemptLock)return;t._lazy.attemptLock=!0,t._lazy.currentAttempt++;const{src:a}=t._lazy;if(w.has(a)){I(t,a),t._lazy.attemptLock=!1;return}q(t),tt(t,a)}async function f(t){await j(),T(t)&&x(t)}function u(){l.forEach(t=>f(t))}async function at(t){!l.includes(t)&&l.push(t),R(t).forEach(K),await f(t)}function A(t){S(l,t),l.length===0&&X()}function et(t,a){const{src:n,arg:g}=t._lazy;return n!==a.value||g!==a.arg}async function N(t,a){J(t,a),await at(t)}async function nt(t,a){if(!et(t,a)){l.includes(t)&&await f(t);return}await N(t,a)}function st(t={}){const{events:a,loading:n,error:g,attempt:B,throttleWait:U,filter:O}=t;e.events=a??e.events,e.loading=n??e.loading,e.error=g??e.error,e.attempt=B??e.attempt,e.throttleWait=U??e.throttleWait,e.filter=O}const ot={mounted:N,unmounted:A,updated:nt,install(t,a){st(a),_=b(u,e.throttleWait),t.directive("lazy",this)}},r=ot,ct={basicUsage:"基本使用",backgroundImageLazyLoad:"背景图懒加载"},rt={basicUsage:"Basic Usage",backgroundImageLazyLoad:"Background Image Lazy Load"},{add:C,use:it,t:k,merge:Lt}=i.useLocale(),lt=t=>{i.use(t),it(t)};i.add("zh-CN",i.zhCN);i.add("en-US",i.enUS);C("zh-CN",ct);C("en-US",rt);const ut={class:"lazy-example-cat"},dt={class:"lazy-example-cat"},mt={class:"lazy-example-cat"},gt={class:"lazy-example-cat"},pt={class:"lazy-example-cat"},_t={class:"lazy-example-cat"},ft={__name:"index",setup(t){return G(lt),(a,n)=>(P(),V(M,null,[y(s(E),null,{default:z(()=>[h(L(s(k)("basicUsage")),1)]),_:1}),o(c("img",ut,null,512),[[s(r),"cat.jpg"]]),o(c("img",dt,null,512),[[s(r),"cat.jpg"]]),o(c("img",mt,null,512),[[s(r),"cat.jpg"]]),o(c("img",gt,null,512),[[s(r),"cat.jpg"]]),o(c("img",pt,null,512),[[s(r),"cat.jpg"]]),y(s(E),null,{default:z(()=>[h(L(s(k)("backgroundImageLazyLoad")),1)]),_:1}),o(c("div",_t,null,512),[[s(r),"cat.jpg","background-image"]])],64))}},Et=D(ft,[["__scopeId","data-v-cf528b09"]]);export{Et as default};
